version: v1
description: Initiating the deployment

steps:
- name: terraform
  image: projectnebula/terraform:latest
  spec:
    provider: aws
    credentials:
      credentials: 
        $type: Secret
        name: credentials
    workspace: padrao
    directory: infra/app    
    git: 
      ssh_key:
        $type: Secret
        name: ssh_key
      known_hosts:
        $type: Secret
        name: known_hosts
      name: my-git-repo
      branch: dev
      repository: git@github.com:Felipenho/nebula.git
- name: msteams-notification
  image: projectnebula/msteams-notification:latest
  spec:
    message: "Inst√¢ncia EC2 Criada com sucesso!"
    webhookURL:
      $type: Secret
      name: hookurl
  dependsOn:
    - echo